<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/basicLayout}">

<th:block layout:fragment="script">
  <script th:inline="javascript">
    let message = [[${message}]];
    if(message != null) alert(message);

    function fCheck() {
      let fName = document.getElementById("sFile").value;
      let maxSize = 1024 * 1024 * 10;
      let ext = fName.substring(fName.lastIndexOf(".")+1).toLowerCase();

      if(fName.trim() == "") {
        alert("업로드할 파일을 선택하세요");
        return false;
      }
      let fileSize = document.getElementById("sFile").files[0].size;

      if(fileSize > maxSize) {
        alert("업로드할 파일의 최대용량은 10MByte 입니다.");
      }

      else if(ext != 'jpg' && ext != 'gif' && ext != 'png') {
        alert("업로드 가능한 파일은 'jpg, gif, png '만 가능합니다.")
      }

      else {
       productForm.submit();
      }
    }
  </script>
</th:block>

<style layout:fragment="css" >
  .row {
    margin: 0px;
    padding: 10px;
    align-items: center;

  }
  .row label {
    margin: 0px;
    flex: 0 0 150px;
    font-size: 14px;
    font-weight: normal;
    border-right: 1px solid #ddd;
  }

  .essential {
    color:blue
  }
  .join__h2 {
    font-size: 16px;
    font-weight: bold;
  }
</style>

<div layout:fragment="content">
  <h2>센서등록</h2>
  <div class="d-flex justify-content-center">
    <form name="productForm" method="post" th:object="${productDTO}" class="flex-grow-1" enctype="multipart/form-data">
      <div class="row mb-2">
        <label th:for="sensorName" class="col-form-label col-2">센서 이름</label>
        <div class="col-sm-6">
          <input type="text" th:field="*{sensorName}" class="form-control" enctype="multipart/form-data">
        </div>
        <div class="col-sm-4">
          <div th:if="${#fields.hasErrors('sensorName')}" th:errors="*{sensorName}" class="fieldError ms-3" style="color:red; font-size:13px; text-align:left">Incorrect data</div>
        </div>
      </div>
      <div class="row mb-2">
        <label th:for="model" class="col-form-label col-2">모델명</label>
        <div class="col-sm-6">
          <input type="text" th:field="*{model}" class="form-control">
        </div>
        <div class="col-sm-4">
          <div th:if="${#fields.hasErrors('model')}" th:errors="*{model}" class="fieldError ms-3" style="color:red; font-size:13px; text-align:left">Incorrect data</div>
        </div>
      </div>
      <div class="row mb-2">
        <label th:for="sensorType" class="col-form-label col-2">센서타입</label>
        <div class="col-sm-6">
          <input type="text" th:field="*{sensorType}" class="form-control">
        </div>
        <div class="col-sm-4">
          <div th:if="${#fields.hasErrors('sensorType')}" th:errors="*{sensorType}" class="fieldError ms-3" style="color:red; font-size:13px; text-align:left">Incorrect data</div>
        </div>
      </div>
      <div class="row mb-2">
        <label th:for="shortDescription" class="col-form-label col-2">한줄소개</label>
        <div class="col-sm-6">
          <input type="text" th:field="*{shortDescription}" class="form-control">
        </div>
      </div>
      <div class="row mb-2">
        <label th:for="features" class="col-form-label col-2">특징</label>
        <div class="col-sm-6">
          <textarea th:field="*{features}" style="height:100px; resize:none;" class="form-control" ></textarea>
        </div>
      </div>
      <div class="row mb-2">
        <label th:for="manufacturer" class="col-form-label col-2">제조사</label>
        <div class="col-sm-6">
          <input type="text" th:field="*{manufacturer}" class="form-control">
        </div>
      </div>
      <div class="row mb-2">
        <label for="sFile" class="col-form-label col-2">이미지</label>
        <div class="col-sm-6">
          <input type="file" id="sFile" name="sFile" class="form-control">
        </div>
      </div>
      <div class="d-flex justify-content-center gap-3 mt-4">
        <button type="button" class="btn btn-dark w-40 px-4" onclick="fCheck()">등록</button>
        <button type="button" class="btn btn-dark w-40 px-4" onclick="location.href='/'">취소</button>
      </div>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
    </form>
  </div>
</div>
</html>