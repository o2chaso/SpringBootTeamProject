<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/basicLayout}">


<th:block layout:fragment="script">
  <script th:inline="javascript">
    'use strict';

    let message = [[${message}]];
    if(message != null) alert(message);

    function pageSizeCheck() {
      let pageSize = document.getElementById("pageSize").value;
      location.href = "/SpringGroupBB/board/boardList?pageSize="+pageSize;
    }
  </script>
  <style>
    a {text-decoration: none}
    a:hover {
      color: orange;
      text-decoration: underline;
    }
  </style>
</th:block>

<div layout:fragment="content">
  <style>
    @charset "UTF-8";
    .search-bg {
      background: #f2f2f2;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
      padding: 18px 20px;
      width: 100%;
      margin: 0;
    }

  </style>
   <div class="device-card">
      <h2 class="font-weight-bold text-primary heading mb-1 text-start" style="font-size:2.2">ììœ ê²Œì‹œíŒ</h2>
      <hr class="secondary">
   </div>

  <div class="device-card">
    <div class="row mt-3 mb-1">
      <div class="col text-start">
      </div>
      <div class="col text-end">
        <select name="pageSize" id="pageSize" onchange="pageSizeCheck()">
          <option th:selected="${pageVO.pageSize==5}">5</option>
          <option th:selected="${pageVO.pageSize==10}">10</option>
          <option th:selected="${pageVO.pageSize==15}">15</option>
          <option th:selected="${pageVO.pageSize==20}">20</option>
          <option th:selected="${pageVO.pageSize==30}">30</option>
          <option th:selected="${pageVO.pageSize==50}">50</option>
        </select>
      </div>
    </div>

    <table class="table">
      <tr style="border-bottom: 3px solid #484848;">
        <th>ë²ˆí˜¸</th>
        <th>ì œëª©</th>
        <th>ì´ë¦„</th>
        <th>ì‘ì„±ì¼</th>
        <th>ì¡°íšŒìˆ˜(â™¥)</th>
      </tr>
      <th:block th:each="board, st : ${pageVO.boardList}"
                th:if="${board.openSw == 'OK'
                        or #authorization.expression('hasAuthority(''ROLE_ADMIN'')')
                        or (board.member != null and board.member.email == #authentication.name)}">
        <tr>
          <td>
            <span th:if="${board.noticeSw == 'OK'}">ğŸ“Œ</span>
            <span th:unless="${board.noticeSw == 'OK'}" th:text="${pageVO.curScrStartNo - st.index}"></span>
          </td>
          <td class="text-start">
            <a th:href="@{/board/boardContent(id=${board.id},pag=${pageVO.pag},pageSize=${pageVO.pageSize})}">[[${board.title}]]</a>
            <th:block th:if="${board.openSw == 'NO'}">
              <span class="badge bg-info">ë¹„ê³µê°œ</span>
            </th:block>
            <th:block th:if="${board.complaint == 'HI'}">
              <span class="badge bg-danger">ì‹ ê³ ì¤‘</span>
            </th:block>
            <th:block th:if="${board.complaint == 'DE'}">
              <span class="badge bg-dark">ì‚­ì œì˜ˆì •</span>
            </th:block>
            <th:block th:if="${board.hourDiff <= 24}"><img th:src="@{/images/new.gif}"></th:block>
            <th:block th:if="${board.replyCnt != 0}">([[${board.replyCnt}]])</th:block>
          </td>
          <td>[[${board.name}]]</td>
          <td>
            <th:block th:if="${board.hourDiff <= 24}">
              <span th:text="${board.dateDiff == 0} ? ${#temporals.format(board.wDate, 'HH:mm:ss')} : ${#temporals.format(board.wDate, 'yyyy-MM-dd HH:mm')}"></span>
            </th:block>
            <th:block th:if="${board.hourDiff > 24}"><span th:text="${#strings.substring(board.wDate,0,10)}"></span></th:block>
          </td>
          <td>[[${board.readNum}]]([[${board.good}]])</td>
        </tr>
      </th:block>
    </table>
    <div class="d-flex align-items-center justify-content-between mb-3">
      <!-- ì™¼ìª½: ê¸€ì“°ê¸° ë²„íŠ¼ -->
      <div>
        <a th:if="${!isSearch}"
           th:href="@{/board/boardInput}"
           class="btn btn-success btn-sm">
          ê¸€ì“°ê¸°
        </a>
        <a th:if="${isSearch}"
           th:href="@{/board/boardList}"
           class="btn btn-outline-secondary btn-sm">
          ëŒì•„ê°€ê¸°
        </a>
      </div>
      <!-- ê°€ìš´ë°: ê²€ìƒ‰í¼ -->
      <form name="searchForm" method="get"
            class="d-flex align-items-center mx-auto"
            style="gap: 8px;">
        <select name="search" id="search"
                style="height:35px; font-size:0.9em;">
          <option value="title"   th:selected="${pageVO.searchStr=='ê¸€ì œëª©'}">ê¸€ì œëª©</option>
          <option value="name"    th:selected="${pageVO.searchStr=='ê¸€ì“´ì´'}">ê¸€ì“´ì´</option>
          <option value="content" th:selected="${pageVO.searchStr=='ê¸€ë‚´ìš©'}">ê¸€ë‚´ìš©</option>
        </select>
        <input type="text" name="searchString" id="searchString"
               th:value="${pageVO.searchString}"
               placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."
               required
               style="height:35px; width:300px; font-size:0.95em;">
        <input type="submit" value="ê²€ìƒ‰" class="btn btn-dark btn-sm px-3">
      </form>
      <!-- ì˜¤ë¥¸ìª½: (ë¹„ì›Œë‘ê±°ë‚˜ í–¥í›„ ë²„íŠ¼ ì¶”ê°€ ê°€ëŠ¥) -->
      <div style="width:80px;"></div>
    </div>
  </div>

  <!-- ë¸”ë¡í˜ì´ì§€ ì‹œì‘ -->
  <div class="text-center">
    <ul class="pagination justify-content-center">
      <th:block th:if="${pageVO.pag > 1}"><li class="page-item"><a class="page-link text-secondary" th:href="@{/board/boardList(pageSize=${pageVO.pageSize},pag=0)}">
        ì²«í˜ì´ì§€</a></li></th:block>
      <th:block th:if="${pageVO.curBlock > 0}"><li class="page-item"><a class="page-link text-secondary" th:href="@{/board/boardList(pageSize=${pageVO.pageSize},pag=${(pageVO.curBlock-1)*pageVO.blockSize+1-1})}">
        ì´ì „ë¸”ë¡</a></li></th:block>
      <th:block th:each="i: ${#numbers.sequence((pageVO.curBlock*pageVO.blockSize)+1,(pageVO.curBlock*pageVO.blockSize)+pageVO.blockSize)}">
        <th:block th:if="${i <= pageVO.totPage && i == pageVO.pag}"><li class="page-item active"><a class="page-link bg-secondary border-secondary" th:href="@{/board/boardList(pageSize=${pageVO.pageSize},pag=${i-1})}" th:text="${i}"></a></li></th:block>
        <th:block th:if="${i <= pageVO.totPage && i != pageVO.pag}"><li class="page-item"><a class="page-link text-secondary" th:href="@{/board/boardList(pageSize=${pageVO.pageSize},pag=${i-1})}" th:text="${i}"></a></li></th:block>
      </th:block>
      <th:block th:if="${pageVO.curBlock < pageVO.lastBlock}"><li class="page-item"><a class="page-link text-secondary" th:href="@{/board/boardList(pageSize=${pageVO.pageSize},pag=${(pageVO.curBlock+1)*pageVO.blockSize+1-1})}">ë‹¤ìŒë¸”ë¡</a></li></th:block>
      <th:block th:if="${pageVO.pag < pageVO.totPage}"><li class="page-item"><a class="page-link text-secondary" th:href="@{/board/boardList(pageSize=${pageVO.pageSize},pag=${pageVO.totPage-1})}">ë§ˆì§€ë§‰í˜ì´ì§€</a></li></th:block>
    </ul>
  </div>
  <!-- ë¸”ë¡í˜ì´ì§€ ë -->

</div>

</html>