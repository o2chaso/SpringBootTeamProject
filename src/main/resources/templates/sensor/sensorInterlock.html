<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/basicLayout}">

<th:block layout:fragment="script">
  <script th:inline="javascript">
    // 기본 선택 장비 코드
    let currentDevice = "ENV_V2_1";

    // 장비 선택 변경
    function changeDevice() {
      currentDevice = $("#deviceSelect").val();
    }

    // 인터락 저장 요청
    function saveThreshold(sensorKey) {
      const alarm = $("#" + sensorKey + "_alarm").val();
      const warning = $("#" + sensorKey + "_warning").val();
      const status = $("#" + sensorKey + "_status").val();

      $.ajax({
        url: "/sensor/threshold/save",
        type: "post",
        data: {
            deviceCode: currentDevice,
            sensorKey: sensorKey,
            alarm: alarm,
            warning: warning,
            status: status
        },
        success: function(res) {
          alert("저장 완료");
        },
        error: function() {
          alert("저장 실패");
        }
      });
    }

  </script>
</th:block>

<div layout:fragment="content">
  <div class="text-start">
    <a th:href="@{/sensor/sensorList}" class="btn btn-primary" style="margin-left: 20px; ont-size: 18px; padding: 8px;">돌아가기</a>
  </div>

  <!-- 상단 선택 박스 -->
  <div style="margin-bottom: 20px;">
    <label style="font-size: 18px; margin-right: 10px;">장치 선택 :</label>
    <select id="deviceSelect" onchange="changeDevice()" style="padding: 8px; font-size: 16px">
      <option value="ENV_V2_1">1층(ENV_V2_1)</option>
      <option value="ENV_V2_2">2층(ENV_V2_2)</option>
      <option value="ENV_V2_3">자재실(ENV_V2_3)</option>
      <option value="ENV_V2_4">개발실(ENV_V2_4)</option>
    </select>
  </div>

  <!-- Interlock 대시보드 -->
  <div class="sensor-grid" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-top: 25px;">
    <!-- 실내온도 -->
    <div class="card p-3" id="value1">
      <h2 class="mb3">실내온도(TEMP)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" id="value1_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="warning" id="value1_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="temp_status" id="value1_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value1')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

    <!-- 상대습도 -->
    <div class="card p-3" id="value2">
      <h2 class="mb3">상대습도(RH)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" name="value2_alarm" id="value2_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="value2_warning" id="value2_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="value2_status" id="value2_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value2')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

    <!-- 이산화탄소 -->
    <div class="card p-3" id="value3">
      <h2 class="mb3">이산화탄소(CO2)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" name="value3_alarm" id="value3_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="value3_warning" id="value3_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="value3_status" id="value3_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value3')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

    <!-- 유기화합물 -->
    <div class="card p-3" id="value4">
      <h2 class="mb3">유기화합물(VOC)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" name="value4_alarm" id="value4_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="value4_warning" id="value4_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="value4_status" id="value4_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value4')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

    <!-- 초미세먼지 -->
    <div class="card p-3" id="value5">
      <h2 class="mb3">초미세먼지(PM1.0)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" name="value5_alarm" id="value5_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="value5_warning" id="value5_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="value5_status" id="value5_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value5')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

    <!-- 초미세먼지 -->
    <div class="card p-3" id="value6">
      <h2 class="mb3">초미세먼지(PM2.5)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" name="value6_alarm" id="value6_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="value6_warning" id="value6_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="value6_status" id="value6_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value6')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

    <!-- 초미세먼지 -->
    <div class="card p-3" id="value7">
      <h2 class="mb3">초미세먼지(PM10)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" name="value7_alarm" id="value7_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="value7_warning" id="value7_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="value7_status" id="value7_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value7')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

    <!-- 온도1 -->
    <div class="card p-3" id="value8">
      <h2 class="mb3">온도_1(1층)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" name="value8_alarm" id="value8_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="value8_warning" id="value8_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="value8_status" id="value8_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value8')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

    <!-- 온도2 -->
    <div class="card p-3" id="value9">
      <h2 class="mb3">온도_2(2층)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" name="value9_alarm" id="value9_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="value9_warning" id="value9_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="value9_status" id="value9_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value9')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

    <!-- 온도3 -->
    <div class="card p-3" id="value10">
      <h2 class="mb3">온도_3(3층)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" name="value10_alarm" id="value10_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="value10_warning" id="value10_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="value10_status" id="value10_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value10')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

    <!-- 소음 -->
    <div class="card p-3" id="value11">
      <h2 class="mb3">소음(NOISE)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" name="value11_alarm" id="value11_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="value11_warning" id="value11_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="value11_status" id="value11_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value11')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

    <!-- 온도(비접촉) -->
    <div class="card p-3" id="value12">
      <h2 class="mb3">온도(비접촉)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" name="value12_alarm" id="value12_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="value12_warning" id="value12_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="value12_status" id="value12_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value12')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

    <!-- 조도 -->
    <div class="card p-3" id="value13">
      <h2 class="mb3">조도(lx)</h2>

      <div class="mb-3">
        <label class="form-label">Alarm</label>
        <input type="number" name="value13_alarm" id="value13_alarm" class="form-control"/>
      </div>

      <div class="mb-3">
        <label class="form-label">Warning</label>
        <input type="number" name="value13_warning" id="value13_warning" class="form-control" />
      </div>

      <div class="mb-2">
        <label class="form-label">ON/OFF</label>
        <select name="value13_status" id="value13_status" class="form-select">
          <option value="ON">ON</option>
          <option value="OFF">OFF</option>
        </select>
      </div>
      <button type="button" onclick="saveThreshold('value13')" class="btn btn-primary btn-sm">저장</button>
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </div>

  </div>
</div>>

</html>